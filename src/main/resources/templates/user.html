<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Java2 Project Demo</title>
    <!--  Import echarts lib by CDN, you can also import from local files  -->
    <script src='https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2/dist/echarts-wordcloud.min.js"></script>
</head>
<body style="text-align: center">
<h1>Rust Tag</h1>
<h4>This is just a demo page</h4>
<div style="width: 100%;height: 60vh;display: flex">
    <div style="width: 50%;height: 100%">
        <div id="piechart" style="height: 100%;width: 100%"></div>
        <div id="piechart1" style="height: 100%;width: 100%"></div>
        <div id="piechart2" style="height: 100%;width: 100%"></div>
        <div id="main" style="height: 100%;width: 100%"></div>
    </div>
</div>
</body>

<script>

    let piechart = echarts.init(document.getElementById('piechart'));

    fetch('../js/distributed_user_post.csv')
        .then(response => response.text())
        .then(csvData => {
            let piechartData = [];
            let Users = []
            const rows = csvData.split('\n');

            // 解析CSV数据
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].replace(", ", " ").split(',');
                const Count = cells[0];
                const Frequency = parseInt(cells[1]);
                const User = cells[2];
                Users.push(User);

                piechartData.push({
                    name: Count,
                    value: Frequency,
                });
            }
            let pieOption = {

                title: {
                    text: 'Problem Count With Corresponding Answer Count',
                    textStyle: {
                        fontStyle: 'oblique',
                        fontSize: 20,
                        color: '#4cc9f0'
                    },
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item'

                },
                grid: {
                    width: '100%',
                    height: '100%'
                },
                legend: {
                    orient: 'vertical',
                    textStyle: {
                        fontSize: 20,
                        color: 'black'
                    },
                    right: 'center',
                    bottom: 'bottom',
                },
                series: [
                    {
                        name: 'Problem Count',
                        type: 'pie',
                        radius: '80%',
                        data: piechartData,
                        color: [ '#4169E1', '#3CB371',
                            '#FFA500', '#FF7F50', '#DC143C', '#000080','#9400D3', '#FF00FF'],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0.1, 0.2, 0, 0.5)',
                            }
                        },
                        itemStyle: {
                            normal: {
                                label: {
                                    formatter(params){
                                       return Users[params.dataIndex];
                                    },
                                    textStyle: {
                                        fontSize: 12,
                                        color: 'black'
                                    }
                                }
                            }
                        }
                    }
                ]
            };
            piechart.setOption(pieOption);
        })


    let piechart1 = echarts.init(document.getElementById('piechart1'));

    fetch('../js/distributed_user_reply.csv')
        .then(response => response.text())
        .then(csvData => {
            let piechartData = [];
            let Users = []
            const rows = csvData.split('\n');

            // 解析CSV数据
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].replace(", ", " ").split(',');
                const Count = cells[0];
                const Frequency = parseInt(cells[1]);
                const User = cells[2];
                Users.push(User);

                piechartData.push({
                    name: Count,
                    value: Frequency,
                });
            }
            let pieOption = {

                title: {
                    text: 'Problem Count With Corresponding Answer Count',
                    textStyle: {
                        fontStyle: 'oblique',
                        fontSize: 20,
                        color: '#4cc9f0'
                    },
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item'

                },
                grid: {
                    width: '100%',
                    height: '100%'
                },
                legend: {
                    orient: 'vertical',
                    textStyle: {
                        fontSize: 20,
                        color: 'black'
                    },
                    right: 'center',
                    bottom: 'bottom',
                },
                series: [
                    {
                        name: 'Problem Count',
                        type: 'pie',
                        radius: '80%',
                        data: piechartData,
                        color: ['#9400D3', '#FF00FF','#FF7F50', '#DC143C', '#000080','#4169E1', '#3CB371',
                            '#FFA500'],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0.1, 0.2, 0, 0.5)',
                            }
                        },
                        itemStyle: {
                            normal: {
                                label: {
                                    formatter(params){
                                        return Users[params.dataIndex];
                                    },
                                    textStyle: {
                                        fontSize: 12,
                                        color: 'black'
                                    }
                                }
                            }
                        }
                    }
                ]
            };
            piechart1.setOption(pieOption);
        })


    let piechart2 = echarts.init(document.getElementById('piechart2'));

    fetch('../js/distributed_user_comment.csv')
        .then(response => response.text())
        .then(csvData => {
            let piechartData = [];
            let Users = []
            const rows = csvData.split('\n');

            // 解析CSV数据
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].replace(", ", " ").split(',');
                const Count = cells[0];
                const Frequency = parseInt(cells[1]);
                const User = cells[2];
                Users.push(User);

                piechartData.push({
                    name: Count,
                    value: Frequency,
                });
            }
            let pieOption = {

                title: {
                    text: 'Problem Count With Corresponding Answer Count',
                    textStyle: {
                        fontStyle: 'oblique',
                        fontSize: 20,
                        color: '#4cc9f0'
                    },
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item'

                },
                grid: {
                    width: '100%',
                    height: '100%'
                },
                legend: {
                    orient: 'vertical',
                    textStyle: {
                        fontSize: 20,
                        color: 'black'
                    },
                    right: 'center',
                    bottom: 'bottom',
                },
                series: [
                    {
                        name: 'Problem Count',
                        type: 'pie',
                        radius: '80%',
                        data: piechartData,
                        color: ['#FFA500', '#FF7F50', '#DC143C', '#000080','#9400D3', '#FF00FF', '#4169E1', '#3CB371',
                            ],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0.1, 0.2, 0, 0.5)',
                            }
                        },
                        itemStyle: {
                            normal: {
                                label: {
                                    formatter(params){
                                        return Users[params.dataIndex];
                                    },
                                    textStyle: {
                                        fontSize: 12,
                                        color: 'black'
                                    }
                                }
                            }
                        }
                    }
                ]
            };
            piechart2.setOption(pieOption);
        })

    var chartDom = document.getElementById('main');
    var myChart = echarts.init(chartDom);
    var option;

    option = {
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'cross',
                crossStyle: {
                    color: '#999'
                }
            }
        },
        toolbox: {
            feature: {
                dataView: { show: true, readOnly: false },
                magicType: { show: true, type: ['line', 'bar'] },
                restore: { show: true },
                saveAsImage: { show: true }
            }
        },
        legend: {
            data: ['Evaporation', 'Precipitation', 'Temperature']
        },
        xAxis: [
            {
                type: 'category',
                data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                axisPointer: {
                    type: 'shadow'
                }
            }
        ],
        yAxis: [
            {
                type: 'value',
                name: 'Precipitation',
                min: 0,
                max: 250,
                interval: 50,
                axisLabel: {
                    formatter: '{value} ml'
                }
            },
            {
                type: 'value',
                name: 'Temperature',
                min: 0,
                max: 25,
                interval: 5,
                axisLabel: {
                    formatter: '{value} °C'
                }
            }
        ],
        series: [
            {
                name: 'Evaporation',
                type: 'bar',
                tooltip: {
                    valueFormatter: function (value) {
                        return value + ' ml';
                    }
                },
                data: [
                    2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3
                ]
            },
            {
                name: 'Precipitation',
                type: 'bar',
                tooltip: {
                    valueFormatter: function (value) {
                        return value + ' ml';
                    }
                },
                data: [
                    2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3
                ]
            },
            {
                name: 'Temperature',
                type: 'line',
                yAxisIndex: 1,
                tooltip: {
                    valueFormatter: function (value) {
                        return value + ' °C';
                    }
                },
                data: [2.0, 2.2, 3.3, 4.5, 6.3, 10.2, 20.3, 23.4, 23.0, 16.5, 12.0, 6.2]
            }
        ]
    };

    option && myChart.setOption(option);

</script>

</html>
